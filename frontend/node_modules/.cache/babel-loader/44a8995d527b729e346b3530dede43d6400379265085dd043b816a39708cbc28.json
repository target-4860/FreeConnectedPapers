{"ast":null,"code":"import * as d3 from 'd3';\nexport default {\n  name: 'KnowledgeGraph',\n  props: {\n    papers: {\n      type: Array,\n      default: () => []\n    },\n    selectedPaper: {\n      type: Object,\n      default: null\n    }\n  },\n  data() {\n    return {\n      simulation: null,\n      svg: null,\n      width: 0,\n      height: 0,\n      nodes: [],\n      links: [],\n      isLoading: false,\n      transform: {\n        x: 0,\n        y: 0,\n        k: 1\n      }\n    };\n  },\n  watch: {\n    papers: {\n      handler(newPapers) {\n        if (newPapers.length > 0) {\n          this.isLoading = true;\n          setTimeout(() => {\n            this.generateGraphData();\n            this.initializeGraph();\n            this.isLoading = false;\n          }, 500);\n        }\n      },\n      deep: true\n    },\n    selectedPaper(newPaper) {\n      if (newPaper && this.svg) {\n        this.highlightNode(newPaper.id);\n      }\n    }\n  },\n  methods: {\n    generateGraphData() {\n      // 生成节点数据\n      this.nodes = this.papers.map(paper => ({\n        id: paper.id,\n        title: paper.title,\n        authors: paper.authors,\n        year: paper.year,\n        citations: paper.citations_count || 0,\n        r: this.calculateRadius(paper.citations_count || 0)\n      }));\n\n      // 生成连接数据\n      this.links = [];\n      this.papers.forEach(paper => {\n        if (paper.references && paper.references.length) {\n          paper.references.forEach(refId => {\n            // 检查引用的论文是否在我们的数据集中\n            if (this.papers.some(p => p.id === refId)) {\n              this.links.push({\n                source: paper.id,\n                target: refId,\n                value: 1\n              });\n            }\n          });\n        }\n      });\n    },\n    calculateRadius(citations) {\n      // 根据引用数量计算节点大小\n      return Math.max(Math.min(Math.log(citations + 1) * 4 + 10, 25), 10);\n    },\n    getNodeColor(year) {\n      // 根据年份分配颜色\n      const currentYear = new Date().getFullYear();\n      const yearsAgo = currentYear - year;\n\n      // 颜色范围从浅色（新）到深色（旧）\n      if (yearsAgo <= 1) return \"#60b3c2\"; // 最新\n      if (yearsAgo <= 3) return \"#3c8b9c\";\n      if (yearsAgo <= 5) return \"#2a7d8b\";\n      if (yearsAgo <= 10) return \"#1a6575\";\n      return \"#0d4e5d\"; // 最旧\n    },\n    initializeGraph() {\n      const container = this.$refs.graphContainer;\n      if (!container) return;\n\n      // 清除之前的图形\n      d3.select(container).selectAll(\"*\").remove();\n\n      // 获取容器尺寸\n      this.width = container.clientWidth;\n      this.height = container.clientHeight;\n\n      // 创建SVG\n      this.svg = d3.select(container).append(\"svg\").attr(\"width\", \"100%\").attr(\"height\", \"100%\").attr(\"viewBox\", [0, 0, this.width, this.height]);\n\n      // 添加缩放和平移功能\n      const zoom = d3.zoom().scaleExtent([0.2, 3]).on(\"zoom\", event => {\n        this.transform = event.transform;\n        g.attr(\"transform\", event.transform);\n      });\n      this.svg.call(zoom);\n      const g = this.svg.append(\"g\");\n\n      // 创建力导向图\n      this.simulation = d3.forceSimulation(this.nodes).force(\"link\", d3.forceLink(this.links).id(d => d.id).distance(100)).force(\"charge\", d3.forceManyBody().strength(-300)).force(\"center\", d3.forceCenter(this.width / 2, this.height / 2)).force(\"collide\", d3.forceCollide().radius(d => d.r + 10));\n\n      // 绘制连接线\n      const link = g.append(\"g\").attr(\"stroke\", \"#999\").attr(\"stroke-opacity\", 0.6).selectAll(\"line\").data(this.links).join(\"line\").attr(\"stroke-width\", d => Math.sqrt(d.value));\n\n      // 绘制节点\n      const node = g.append(\"g\").selectAll(\".node\").data(this.nodes).join(\"g\").attr(\"class\", \"node\").call(this.drag(this.simulation));\n\n      // 节点圆形\n      node.append(\"circle\").attr(\"r\", d => d.r).attr(\"fill\", d => this.getNodeColor(d.year)).attr(\"stroke\", \"#fff\").attr(\"stroke-width\", 1.5).on(\"click\", (event, d) => {\n        this.$emit('select-paper', this.papers.find(p => p.id === d.id));\n      });\n\n      // 节点文本\n      node.append(\"text\").text(d => this.getTruncatedTitle(d.title)).attr(\"dy\", d => d.r + 15).attr(\"text-anchor\", \"middle\").attr(\"font-size\", \"8px\").attr(\"fill\", \"#333\");\n\n      // 添加悬停提示\n      node.append(\"title\").text(d => `${d.title}\\n作者: ${d.authors.join(\", \")}\\n年份: ${d.year}\\n引用数: ${d.citations}`);\n\n      // 更新力导向图\n      this.simulation.on(\"tick\", () => {\n        link.attr(\"x1\", d => d.source.x).attr(\"y1\", d => d.source.y).attr(\"x2\", d => d.target.x).attr(\"y2\", d => d.target.y);\n        node.attr(\"transform\", d => `translate(${d.x},${d.y})`);\n      });\n    },\n    drag(simulation) {\n      function dragstarted(event) {\n        if (!event.active) simulation.alphaTarget(0.3).restart();\n        event.subject.fx = event.subject.x;\n        event.subject.fy = event.subject.y;\n      }\n      function dragged(event) {\n        event.subject.fx = event.x;\n        event.subject.fy = event.y;\n      }\n      function dragended(event) {\n        if (!event.active) simulation.alphaTarget(0);\n        event.subject.fx = null;\n        event.subject.fy = null;\n      }\n      return d3.drag().on(\"start\", dragstarted).on(\"drag\", dragged).on(\"end\", dragended);\n    },\n    getTruncatedTitle(title) {\n      if (!title) return '';\n      return title.length > 20 ? title.substring(0, 20) + '...' : title;\n    },\n    highlightNode(nodeId) {\n      if (!this.svg) return;\n\n      // 重置所有节点\n      this.svg.selectAll(\"circle\").attr(\"stroke\", \"#fff\").attr(\"stroke-width\", 1.5);\n\n      // 高亮选中的节点\n      this.svg.selectAll(\".node\").each(function (d) {\n        if (d.id === nodeId) {\n          d3.select(this).select(\"circle\").attr(\"stroke\", \"#ff5722\").attr(\"stroke-width\", 3);\n        }\n      });\n    },\n    resetGraph() {\n      if (!this.svg) return;\n      const container = this.$refs.graphContainer;\n      const width = container.clientWidth;\n      const height = container.clientHeight;\n\n      // 重置缩放和平移\n      this.svg.transition().duration(750).call(d3.zoom().transform, d3.zoomIdentity.translate(0, 0).scale(1));\n\n      // 重新开始模拟\n      this.simulation.alpha(0.3).restart();\n    },\n    centerGraph() {\n      if (!this.svg || !this.selectedPaper) return;\n      const container = this.$refs.graphContainer;\n      const width = container.clientWidth;\n      const height = container.clientHeight;\n\n      // 查找选中节点\n      const selectedNode = this.nodes.find(n => n.id === this.selectedPaper.id);\n      if (selectedNode) {\n        // 计算居中变换\n        const scale = 1.5;\n        const x = width / 2 - selectedNode.x * scale;\n        const y = height / 2 - selectedNode.y * scale;\n\n        // 应用变换\n        this.svg.transition().duration(750).call(d3.zoom().transform, d3.zoomIdentity.translate(x, y).scale(scale));\n\n        // 高亮节点\n        this.highlightNode(selectedNode.id);\n      }\n    }\n  },\n  mounted() {\n    // 窗口大小变化时重新渲染图谱\n    window.addEventListener('resize', this.initializeGraph);\n  },\n  beforeUnmount() {\n    window.removeEventListener('resize', this.initializeGraph);\n    if (this.simulation) {\n      this.simulation.stop();\n    }\n  }\n};","map":{"version":3,"names":["d3","name","props","papers","type","Array","default","selectedPaper","Object","data","simulation","svg","width","height","nodes","links","isLoading","transform","x","y","k","watch","handler","newPapers","length","setTimeout","generateGraphData","initializeGraph","deep","newPaper","highlightNode","id","methods","map","paper","title","authors","year","citations","citations_count","r","calculateRadius","forEach","references","refId","some","p","push","source","target","value","Math","max","min","log","getNodeColor","currentYear","Date","getFullYear","yearsAgo","container","$refs","graphContainer","select","selectAll","remove","clientWidth","clientHeight","append","attr","zoom","scaleExtent","on","event","g","call","forceSimulation","force","forceLink","d","distance","forceManyBody","strength","forceCenter","forceCollide","radius","link","join","sqrt","node","drag","$emit","find","text","getTruncatedTitle","dragstarted","active","alphaTarget","restart","subject","fx","fy","dragged","dragended","substring","nodeId","each","resetGraph","transition","duration","zoomIdentity","translate","scale","alpha","centerGraph","selectedNode","n","mounted","window","addEventListener","beforeUnmount","removeEventListener","stop"],"sources":["D:\\FreeConnectedPapers\\frontend\\src\\components\\KnowledgeGraph.vue"],"sourcesContent":["<template>\r\n  <div class=\"knowledge-graph\">\r\n    <div class=\"graph-controls\">\r\n      <button @click=\"resetGraph\" class=\"control-button\">\r\n        重置视图\r\n      </button>\r\n      <button @click=\"centerGraph\" class=\"control-button\">\r\n        居中\r\n      </button>\r\n    </div>\r\n    \r\n    <div class=\"loading-overlay\" v-if=\"isLoading\">\r\n      <div class=\"loading-spinner\"></div>\r\n      <div class=\"loading-text\">加载中...</div>\r\n    </div>\r\n    \r\n    <div ref=\"graphContainer\" class=\"graph-container\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as d3 from 'd3';\r\n\r\nexport default {\r\n  name: 'KnowledgeGraph',\r\n  props: {\r\n    papers: {\r\n      type: Array,\r\n      default: () => []\r\n    },\r\n    selectedPaper: {\r\n      type: Object,\r\n      default: null\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      simulation: null,\r\n      svg: null,\r\n      width: 0,\r\n      height: 0,\r\n      nodes: [],\r\n      links: [],\r\n      isLoading: false,\r\n      transform: {\r\n        x: 0,\r\n        y: 0,\r\n        k: 1\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    papers: {\r\n      handler(newPapers) {\r\n        if (newPapers.length > 0) {\r\n          this.isLoading = true;\r\n          setTimeout(() => {\r\n            this.generateGraphData();\r\n            this.initializeGraph();\r\n            this.isLoading = false;\r\n          }, 500);\r\n        }\r\n      },\r\n      deep: true\r\n    },\r\n    selectedPaper(newPaper) {\r\n      if (newPaper && this.svg) {\r\n        this.highlightNode(newPaper.id);\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    generateGraphData() {\r\n      // 生成节点数据\r\n      this.nodes = this.papers.map(paper => ({\r\n        id: paper.id,\r\n        title: paper.title,\r\n        authors: paper.authors,\r\n        year: paper.year,\r\n        citations: paper.citations_count || 0,\r\n        r: this.calculateRadius(paper.citations_count || 0)\r\n      }));\r\n      \r\n      // 生成连接数据\r\n      this.links = [];\r\n      this.papers.forEach(paper => {\r\n        if (paper.references && paper.references.length) {\r\n          paper.references.forEach(refId => {\r\n            // 检查引用的论文是否在我们的数据集中\r\n            if (this.papers.some(p => p.id === refId)) {\r\n              this.links.push({\r\n                source: paper.id,\r\n                target: refId,\r\n                value: 1\r\n              });\r\n            }\r\n          });\r\n        }\r\n      });\r\n    },\r\n    \r\n    calculateRadius(citations) {\r\n      // 根据引用数量计算节点大小\r\n      return Math.max(Math.min(Math.log(citations + 1) * 4 + 10, 25), 10);\r\n    },\r\n    \r\n    getNodeColor(year) {\r\n      // 根据年份分配颜色\r\n      const currentYear = new Date().getFullYear();\r\n      const yearsAgo = currentYear - year;\r\n      \r\n      // 颜色范围从浅色（新）到深色（旧）\r\n      if (yearsAgo <= 1) return \"#60b3c2\"; // 最新\r\n      if (yearsAgo <= 3) return \"#3c8b9c\";\r\n      if (yearsAgo <= 5) return \"#2a7d8b\";\r\n      if (yearsAgo <= 10) return \"#1a6575\";\r\n      return \"#0d4e5d\"; // 最旧\r\n    },\r\n    \r\n    initializeGraph() {\r\n      const container = this.$refs.graphContainer;\r\n      if (!container) return;\r\n      \r\n      // 清除之前的图形\r\n      d3.select(container).selectAll(\"*\").remove();\r\n      \r\n      // 获取容器尺寸\r\n      this.width = container.clientWidth;\r\n      this.height = container.clientHeight;\r\n      \r\n      // 创建SVG\r\n      this.svg = d3.select(container)\r\n        .append(\"svg\")\r\n        .attr(\"width\", \"100%\")\r\n        .attr(\"height\", \"100%\")\r\n        .attr(\"viewBox\", [0, 0, this.width, this.height]);\r\n      \r\n      // 添加缩放和平移功能\r\n      const zoom = d3.zoom()\r\n        .scaleExtent([0.2, 3])\r\n        .on(\"zoom\", (event) => {\r\n          this.transform = event.transform;\r\n          g.attr(\"transform\", event.transform);\r\n        });\r\n      \r\n      this.svg.call(zoom);\r\n      \r\n      const g = this.svg.append(\"g\");\r\n      \r\n      // 创建力导向图\r\n      this.simulation = d3.forceSimulation(this.nodes)\r\n        .force(\"link\", d3.forceLink(this.links).id(d => d.id).distance(100))\r\n        .force(\"charge\", d3.forceManyBody().strength(-300))\r\n        .force(\"center\", d3.forceCenter(this.width / 2, this.height / 2))\r\n        .force(\"collide\", d3.forceCollide().radius(d => d.r + 10));\r\n      \r\n      // 绘制连接线\r\n      const link = g.append(\"g\")\r\n        .attr(\"stroke\", \"#999\")\r\n        .attr(\"stroke-opacity\", 0.6)\r\n        .selectAll(\"line\")\r\n        .data(this.links)\r\n        .join(\"line\")\r\n        .attr(\"stroke-width\", d => Math.sqrt(d.value));\r\n      \r\n      // 绘制节点\r\n      const node = g.append(\"g\")\r\n        .selectAll(\".node\")\r\n        .data(this.nodes)\r\n        .join(\"g\")\r\n        .attr(\"class\", \"node\")\r\n        .call(this.drag(this.simulation));\r\n      \r\n      // 节点圆形\r\n      node.append(\"circle\")\r\n        .attr(\"r\", d => d.r)\r\n        .attr(\"fill\", d => this.getNodeColor(d.year))\r\n        .attr(\"stroke\", \"#fff\")\r\n        .attr(\"stroke-width\", 1.5)\r\n        .on(\"click\", (event, d) => {\r\n          this.$emit('select-paper', this.papers.find(p => p.id === d.id));\r\n        });\r\n      \r\n      // 节点文本\r\n      node.append(\"text\")\r\n        .text(d => this.getTruncatedTitle(d.title))\r\n        .attr(\"dy\", d => d.r + 15)\r\n        .attr(\"text-anchor\", \"middle\")\r\n        .attr(\"font-size\", \"8px\")\r\n        .attr(\"fill\", \"#333\");\r\n      \r\n      // 添加悬停提示\r\n      node.append(\"title\")\r\n        .text(d => `${d.title}\\n作者: ${d.authors.join(\", \")}\\n年份: ${d.year}\\n引用数: ${d.citations}`);\r\n      \r\n      // 更新力导向图\r\n      this.simulation.on(\"tick\", () => {\r\n        link\r\n          .attr(\"x1\", d => d.source.x)\r\n          .attr(\"y1\", d => d.source.y)\r\n          .attr(\"x2\", d => d.target.x)\r\n          .attr(\"y2\", d => d.target.y);\r\n        \r\n        node.attr(\"transform\", d => `translate(${d.x},${d.y})`);\r\n      });\r\n    },\r\n    \r\n    drag(simulation) {\r\n      function dragstarted(event) {\r\n        if (!event.active) simulation.alphaTarget(0.3).restart();\r\n        event.subject.fx = event.subject.x;\r\n        event.subject.fy = event.subject.y;\r\n      }\r\n      \r\n      function dragged(event) {\r\n        event.subject.fx = event.x;\r\n        event.subject.fy = event.y;\r\n      }\r\n      \r\n      function dragended(event) {\r\n        if (!event.active) simulation.alphaTarget(0);\r\n        event.subject.fx = null;\r\n        event.subject.fy = null;\r\n      }\r\n      \r\n      return d3.drag()\r\n        .on(\"start\", dragstarted)\r\n        .on(\"drag\", dragged)\r\n        .on(\"end\", dragended);\r\n    },\r\n    \r\n    getTruncatedTitle(title) {\r\n      if (!title) return '';\r\n      return title.length > 20 ? title.substring(0, 20) + '...' : title;\r\n    },\r\n    \r\n    highlightNode(nodeId) {\r\n      if (!this.svg) return;\r\n      \r\n      // 重置所有节点\r\n      this.svg.selectAll(\"circle\")\r\n        .attr(\"stroke\", \"#fff\")\r\n        .attr(\"stroke-width\", 1.5);\r\n      \r\n      // 高亮选中的节点\r\n      this.svg.selectAll(\".node\").each(function(d) {\r\n        if (d.id === nodeId) {\r\n          d3.select(this).select(\"circle\")\r\n            .attr(\"stroke\", \"#ff5722\")\r\n            .attr(\"stroke-width\", 3);\r\n        }\r\n      });\r\n    },\r\n    \r\n    resetGraph() {\r\n      if (!this.svg) return;\r\n      \r\n      const container = this.$refs.graphContainer;\r\n      const width = container.clientWidth;\r\n      const height = container.clientHeight;\r\n      \r\n      // 重置缩放和平移\r\n      this.svg.transition()\r\n        .duration(750)\r\n        .call(\r\n          d3.zoom().transform,\r\n          d3.zoomIdentity.translate(0, 0).scale(1)\r\n        );\r\n      \r\n      // 重新开始模拟\r\n      this.simulation\r\n        .alpha(0.3)\r\n        .restart();\r\n    },\r\n    \r\n    centerGraph() {\r\n      if (!this.svg || !this.selectedPaper) return;\r\n      \r\n      const container = this.$refs.graphContainer;\r\n      const width = container.clientWidth;\r\n      const height = container.clientHeight;\r\n      \r\n      // 查找选中节点\r\n      const selectedNode = this.nodes.find(n => n.id === this.selectedPaper.id);\r\n      \r\n      if (selectedNode) {\r\n        // 计算居中变换\r\n        const scale = 1.5;\r\n        const x = width / 2 - selectedNode.x * scale;\r\n        const y = height / 2 - selectedNode.y * scale;\r\n        \r\n        // 应用变换\r\n        this.svg.transition()\r\n          .duration(750)\r\n          .call(\r\n            d3.zoom().transform,\r\n            d3.zoomIdentity.translate(x, y).scale(scale)\r\n          );\r\n        \r\n        // 高亮节点\r\n        this.highlightNode(selectedNode.id);\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    // 窗口大小变化时重新渲染图谱\r\n    window.addEventListener('resize', this.initializeGraph);\r\n  },\r\n  beforeUnmount() {\r\n    window.removeEventListener('resize', this.initializeGraph);\r\n    if (this.simulation) {\r\n      this.simulation.stop();\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.knowledge-graph {\r\n  position: relative;\r\n  width: 100%;\r\n  height: 100%;\r\n  background-color: #f9fafb;\r\n  overflow: hidden;\r\n}\r\n\r\n.graph-container {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.graph-controls {\r\n  position: absolute;\r\n  top: 1rem;\r\n  right: 1rem;\r\n  z-index: 10;\r\n  display: flex;\r\n  gap: 0.5rem;\r\n}\r\n\r\n.control-button {\r\n  background-color: rgba(255, 255, 255, 0.9);\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n  padding: 0.4rem 0.8rem;\r\n  font-size: 0.85rem;\r\n  cursor: pointer;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.control-button:hover {\r\n  background-color: #2a7d8b;\r\n  color: white;\r\n  border-color: #2a7d8b;\r\n}\r\n\r\n.loading-overlay {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background-color: rgba(255, 255, 255, 0.8);\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n  z-index: 20;\r\n}\r\n\r\n.loading-spinner {\r\n  width: 40px;\r\n  height: 40px;\r\n  border: 4px solid rgba(42, 125, 139, 0.2);\r\n  border-radius: 50%;\r\n  border-top-color: #2a7d8b;\r\n  animation: spin 1s linear infinite;\r\n}\r\n\r\n.loading-text {\r\n  margin-top: 1rem;\r\n  color: #2a7d8b;\r\n  font-weight: 500;\r\n}\r\n\r\n@keyframes spin {\r\n  to { transform: rotate(360deg); }\r\n}\r\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}